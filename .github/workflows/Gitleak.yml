name: gitleaks

on: [push,pull_request]

 
jobs:
  gitleaks:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: '0'

    - name: gitleaks-action
      uses: JTheinert/gitleaks-action@master
    - name: Gitleaks report
      if: ${{ always() }}
      uses: actions/upload-artifact@v2
      with:
         name: gitleaks report
         path: gitleaks-report.json
    - name: Annotate
      uses: yuzutech/annotations-action@v0.1.0
      with:
        title: 'push'
        repo-token: "${{ secrets.GITHUB_TOKEN }}"
        input: './annotations.json'
